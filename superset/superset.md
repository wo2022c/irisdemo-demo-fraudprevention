
http://sojen0:9094/csp/sys/exp/%25CSP.UI.Portal.SQL.Home.zen?$NAMESPACE=APP
# change date
UPDATE IRISDemo.BC_TRANSACTIONS
SET BC_TRANS_DATE = 
  TO_TIMESTAMP(
    '2025' || TO_CHAR(BC_TRANS_DATE, '-MM-DD HH24:MI:SS'),
    'YYYY-MM-DD HH24:MI:SS'
  )
---------
DELETE FROM IRISDemo.BC_TRANSACTIONS
WHERE BC_TRANS_IS_FRAUD IS NULL;  
---------
UPDATE IRISDemo.BC_TRANSACTIONS
SET BC_TRANS_WAS_BLOCKED = BC_TRANS_IS_FRAUD;
----
SELECT 
ID, BC_TRANS_AMOUNT, CITY, BC_TRANS_SRC_ACC, BC_TRANS_SRC_ACC_NEW_BAL, BC_TRANS_SRC_ACC_OLD_BAL, BC_TRANS_IS_FRAUD, LATITUDE, LONGITUDE, BC_TRANS_DEST_ACC, BC_TRANS_DEST_ACC_NEW_BAL, BC_TRANS_DEST_ACC_OLD_BAL, BC_TRANS_DATE, BC_TRANS_TYPE, BC_TRANS_NUM, BC_TRANS_WAS_BLOCKED, BC_TRANS_WHITELISTED_BY
FROM IRISDemo.BC_TRANSACTIONS
# change fraud

# update insertion gen 
# generation random city longitude latitude


SELECT
  ID,
  BC_TRANS_IS_FRAUD,
  CITY             AS CurrentCity,
  CASE 
    WHEN FLOOR(MOD(ID,95)+1) < 10 
      THEN 'FR-0' || CAST(FLOOR(MOD(ID,95)+1) AS VARCHAR(2))
    ELSE 
      'FR-'  || CAST(FLOOR(MOD(ID,95)+1) AS VARCHAR(2))
  END AS GeneratedCity
FROM IRISDemo.BC_TRANSACTIONS
WHERE BC_TRANS_IS_FRAUD = 1
ORDER BY ID;



UPDATE IRISDemo.BC_TRANSACTIONS
SET CITY = 
  CASE 
    WHEN (MOD(ID,95) + 1) < 10 
      THEN 'FR-0' || CAST(MOD(ID,95)+1 AS VARCHAR(2))
    ELSE 
      'FR-'  || CAST(MOD(ID,95)+1 AS VARCHAR(2))
  END
WHERE BC_TRANS_IS_FRAUD = 1;



UPDATE IRISDemo.BC_TRANSACTIONS
SET CITY = 
  CASE 
    WHEN FLOOR(MOD(ID,95)+1) < 10 
      THEN 'FR-0' || CAST(FLOOR(MOD(ID,95)+1) AS VARCHAR(2))
    ELSE 
      'FR-'  || CAST(FLOOR(MOD(ID,95)+1) AS VARCHAR(2))
  END
WHERE BC_TRANS_IS_FRAUD = 1 AND CITY is NULL;



SELECT top 5
  ID,CITY
from IRISDemo.BC_TRANSACTIONS
WHERE BC_TRANS_IS_FRAUD = 1 AND CITY is NULL
ORDER BY ID;